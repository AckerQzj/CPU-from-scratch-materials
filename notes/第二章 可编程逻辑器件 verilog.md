# 可编程逻辑器件综述

PLD programmable logic device 可编程逻辑器件

包含：PLA PAL GAL PROM EPLD CPLD FPGA

**基于乘积项（Product-Term）结构的PLD器件**

任何组合逻辑都能化为与门和或门两级电路组合实现，时序电路在此基础上加上存储元件（触发器）构成。

包含输入输出缓冲电路，与阵列，或阵列

这种基于乘积项的器件规模受到限制

**基于查找表（LUT）结构的PLD器件**

原理类似ROM，物理结构基于静态存储器和数据选择器

函数值放入SRAM中，地址线即为输入变量，根据MUX找到函数值输出

N个输入项~2^N位容量

查找表的输入变量一般不超过5个，多于5个输入变量的函数通过多个查找表级联组合实现

绝大多数FPGA结构都基于SRAM查找表实现

# 基于PLD的数字系统设计流程

设计输入 

综合					功能仿真

PLD布线/适配	时序仿真

PLD编程下载	 在线测试

#### 设计输入

主要是画原理图，HDL文本输入

HDL可以进行算法级，RTL，门级逻辑设计

#### 综合

synthesis：把较高级抽象层次的设计描述转化成较低层次描述的过程

算法/行为描述 -> RTL

RTL -> 逻辑门级，逻辑综合

逻辑门 -> PLD配置网表

**综合其实就是指从高抽象层级转换到低抽象层级的过程**

#### 布局布线

把synthesis阶段生成的电路网表映射到具体的PLD器件，并产生最终可以下载的文件的过程，把整个设计分为多个适合PLD期间内部逻辑资源实现的逻辑小块。

布局：把分割的逻辑小块放到PLD器件内部逻辑资源的具体位置，使之便于连线

布线：各个模块，各个信号之间的连接

#### 下载

把布局布线过程中产生的器件变成文件放入PLD的过程称为下载，对FPGA的下载一般称之为配置

# Verilog HDL

### 整数常量

eg：8'b11000011

### 变量 数据类型

net型变量：硬件电路中的各种物理连接 其中wire是最常用的

对于综合器而言，wire可以取0，1，X，Z，X表示不确定或者未知的逻辑状态，Z表示高阻态。在未赋值的情况下，默认为高阻态Z

variable型变量：主要是reg，一般对应触发器或者锁存器，但是在综合时会根据被赋值的情况来确定映射成连线还是存储单元，必须在过程语句initial或者always中实现（过程赋值）

### 运算符

①== 和 === 的区别：

对于==运算，参与比较的两个操作数必须逐位相等结果才为1，如果某些值位X或Z，得到不定值X

对于===运算，X和Z也要进行比较

②缩位运算符&：

reg[3:0] a;

b = &a => b = a0&a1&a2&a3

③位拼接：

{重复次数{被重复数据}}

### 行为语句

always

initial语句不带触发条件，只执行一次，通常用于赋初值，通常不能被综合

### 赋值语句

持续赋值 assign（可以理解为，即时更新的组合逻辑，只要右侧的信号发生变化，就会引起左侧线网值的改变，信号值由驱动源决定）

过程赋值

非阻塞 <= 非阻塞赋值，值不会立即改变 并发

阻塞赋值 = 阻塞赋值在语句结束后就完成赋值操作 顺序

☆同一个赋值语句块只能使用其中一种

### 条件语句

if else if else

case语句：做全等比较

casez语句：比较的双方的某些位为高阻态Z，这些位的比较结果不予考虑

casex语句：比较的双方的某些位为Z或者X，比较结果不考虑

### 循环语句

for while

forever begin end

repeat(time) begin end

### 编译指示

`define

`include

`ifdef

`else

`endif

# 电路设计举例

设计一个inst_fetch模块

仿真：ModelSim仿真

### 系统函数

$readmemh 只能用在仿真中，用于初始化存储单元

其他的系统函数：

$time显示时间

$display显示信号值

$stop暂停仿真

$finish结束仿真

### 时钟信号

通过设计TestBench给出时钟信号，激励信号定义为reg以保存值

Test Bench中要将被测试模块的元件例化

Test Bench只有模块名，没有端口列表

